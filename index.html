<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miscrits Map - Interactive Guide</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ Miscrits Map</h1>
            <p>Interactive guide to all Miscrits by location and rarity</p>
            <div class="time-display">
                <div class="current-time">
                    <span class="time-label">Current Time (GMT+0):</span>
                    <span id="current-time" class="time-value">--:--:--</span>
                </div>
                <div class="countdown-time">
                    <span class="time-label">Time until midnight:</span>
                    <span id="countdown-time" class="time-value">--:--:--</span>
                </div>
            </div>
            
            <!-- Admin Help Section -->
            <div id="admin-help-section" class="admin-help-section" style="display: none;">
                <div class="admin-help-toggle">
                    <h3>üìö Admin Mode Guide</h3>
                    <button id="admin-help-toggle-btn" class="help-toggle-btn">Show Help</button>
                </div>
                <div id="admin-help-content" class="admin-help-content" style="display: none;">
                    <div class="help-section">
                        <h4>üéØ Getting Started</h4>
                        <p>Welcome to Admin Mode! Here you can create, edit, and manage Miscrit markers on the interactive maps. This mode allows you to add precise location information and images to help other players find specific Miscrits.</p>
                    </div>
                    
                    <div class="help-section">
                        <h4>üìç Adding Markers</h4>
                        <ul>
                            <li><strong>Right-click on any map image</strong> to create a new marker at that location</li>
                            <li>Fill in the marker details: Miscrit name</li>
                            <li>Click <strong>Save</strong> to create the marker</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>‚úèÔ∏è Editing Markers</h4>
                        <ul>
                            <li><strong>Right-click on existing markers</strong> to open the context menu</li>
                            <li><strong>Edit Marker:</strong> Modify days of week availability, additional information, and exact location images</li>
                            <li><strong>Move:</strong> Drag the marker to a new position on the map</li>
                            <li><strong>Remove:</strong> Delete the marker completely</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>üìÖ Days of Week System</h4>
                        <ul>
                            <li>Set which days each Miscrit can be caught (Monday through Sunday)</li>
                            <li>Visual indicators show availability on Miscrit tiles</li>
                            <li>Use the day filter to show only Miscrits available on specific days</li>
                            <li>If no custom days are set, Miscrits are available all days by default</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>üñºÔ∏è Exact Location Images</h4>
                        <ul>
                            <li>Add multiple images showing the exact location where Miscrits can be found</li>
                            <li>Images help other players identify the precise spots on maps</li>
                            <li>Use image URLs from hosting services or local assets</li>
                            <li>Images are displayed in the marker information modal</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>üíæ Data Management</h4>
                        <ul>
                            <li><strong>Data Sources:</strong> Switch between Local Storage (your custom data) and JSON file (default data)</li>
                            <li><strong>Export Data:</strong> Download all your markers and availability data as a JSON file</li>
                            <li><strong>Import from JSON:</strong> Load the default marker data into your local storage</li>
                            <li><strong>Load from File:</strong> Upload a previously exported JSON file</li>
                            <li><strong>Clear All Markers:</strong> Remove all marker data (with confirmation)</li>
                            <li><strong>Clear All Dates:</strong> Remove all day-of-week availability data</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>üîç Viewing Marker Information</h4>
                        <ul>
                            <li><strong>Left-click on markers</strong> to view detailed information modal</li>
                            <li><strong>Click Miscrit tiles</strong> with "Click to see exact location" to view marker info</li>
                            <li>Modal shows all Miscrits at the location, additional information, and exact location images</li>
                            <li>Click images to view them in full size in a new tab</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>‚ö†Ô∏è Important Notes</h4>
                        <ul>
                            <li><strong>Local Storage:</strong> Your data is saved in your browser - export regularly for backup</li>
                            <li><strong>JSON Mode:</strong> Read-only mode - switch to Local Storage to make changes</li>
                            <li><strong>Browser Data:</strong> Clearing browser data will remove your markers unless exported</li>
                            <li><strong>Sharing:</strong> Export your data and share the JSON file with other players</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h4>üéÆ Tips & Best Practices</h4>
                        <ul>
                            <li>Use descriptive additional information to help other players</li>
                            <li>Take clear screenshots for exact location images</li>
                            <li>Test your markers by switching to regular mode and viewing them</li>
                            <li>Export your data regularly to avoid losing your work</li>
                            <li>Use the day filter to verify your availability settings work correctly</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <span>Loading Miscrits data...</span>
            </div>
        </header>

        <main id="main-content" style="display: none;">
            <div class="stats" id="stats">
                <div class="stat-item">
                    <span class="stat-number" id="total-miscrits">0</span>
                    <span class="stat-label">Total Miscrits</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="total-locations">0</span>
                    <span class="stat-label">Locations</span>
                </div>
                <div class="export-section">
                    <button id="admin-mode-btn" class="export-btn">Enter Admin Mode</button>
                    <div id="admin-controls" class="admin-controls" style="display: none;">
                        <div class="admin-row">
                            <button id="export-data-btn" class="export-btn admin-btn">Export Data</button>
                            <button id="clear-markers-btn" class="export-btn admin-btn clear-btn">Clear All Markers</button>
                            <button id="clear-dates-btn" class="export-btn admin-btn clear-btn">Clear All Dates</button>
                            <button id="exit-admin-btn" class="export-btn admin-btn exit-btn">Exit Admin Mode</button>
                        </div>
                        <div class="admin-row">
                            <label for="data-source-select" class="data-source-label">Data Source:</label>
                            <select id="data-source-select" class="data-source-select">
                                <option value="local">Local Storage</option>
                                <option value="json" selected>miscrits_data.json</option>
                            </select>
                            <button id="import-json-btn" class="export-btn admin-btn">Import from JSON</button>
                            <button id="load-file-btn" class="export-btn admin-btn">Load from File</button>
                        </div>
                        <input type="file" id="file-input" accept=".json" style="display: none;">
                    </div>
                </div>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <label for="location-filter">Filter by Location:</label>
                    <select id="location-filter">
                        <option value="">All Locations</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="area-filter">Filter by Area:</label>
                    <select id="area-filter">
                        <option value="">All Areas</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="rarity-filter">Filter by Rarity:</label>
                    <select id="rarity-filter">
                        <option value="">All Rarities</option>
                        <option value="Common">Common</option>
                        <option value="Rare">Rare</option>
                        <option value="Epic">Epic</option>
                        <option value="Exotic">Exotic</option>
                        <option value="Legendary">Legendary</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="element-filter">Filter by Element:</label>
                    <select id="element-filter">
                        <option value="">All Elements</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="day-filter">Filter by Day:</label>
                    <select id="day-filter">
                        <option value="">All Days</option>
                        <option value="today">Today</option>
                        <option value="mon">Monday</option>
                        <option value="tue">Tuesday</option>
                        <option value="wed">Wednesday</option>
                        <option value="thu">Thursday</option>
                        <option value="fri">Friday</option>
                        <option value="sat">Saturday</option>
                        <option value="sun">Sunday</option>
                    </select>
                </div>
                <div class="filter-group">
                    <input type="text" id="search-filter" placeholder="Search miscrits...">
                </div>
            </div>

            <div class="miscrits-container" id="miscrits-container">
                <!-- Miscrits will be dynamically loaded here -->
            </div>
        </main>

        <div class="error" id="error" style="display: none;">
            <h2>‚ùå Error Loading Data</h2>
            <p id="error-message">Failed to load Miscrits data. Please try again later.</p>
            <div class="error-buttons">
                <button onclick="location.reload()">Retry</button>
                <button id="clear-storage-btn" class="clear-btn">Clear Local Storage</button>
            </div>
        </div>
    </div>

    <!-- Marker Info Modal -->
    <div id="marker-info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Marker Information</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="modal-miscrits-list"></div>
                <div id="modal-additional-info"></div>
                <div id="modal-exact-images"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
